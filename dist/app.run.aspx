<%-- --%>
<%--  --%>
<%@ Page language="C#" MasterPageFile="~masterurl/default.master"
        Inherits="Microsoft.SharePoint.WebPartPages.WebPartPage,Microsoft.SharePoint,Version=12.0.0.0,Culture=neutral,PublicKeyToken=71e9bce111e9429c" %>
<%@ Register
        Tagprefix="SharePoint"
        Namespace="Microsoft.SharePoint.WebControls"
        Assembly="Microsoft.SharePoint, Version=12.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" %>
<%@ Register
        Tagprefix="Utilities"
        Namespace="Microsoft.SharePoint.Utilities"
        Assembly="Microsoft.SharePoint, Version=12.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" %>
<%@ Import Namespace="Microsoft.SharePoint" %>
<%@ Register
        Tagprefix="WebPartPages"
        Namespace="Microsoft.SharePoint.WebPartPages"
        Assembly="Microsoft.SharePoint, Version=12.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" %>
<asp:Content ContentPlaceHolderId="PlaceHolderPageTitle" runat="server">Light Board</asp:Content>
<asp:Content ContentPlaceHolderId="PlaceHolderPageTitleInTitleArea" runat="server">Light Board</asp:Content>
<asp:Content ContentPlaceHolderId="PlaceHolderAdditionalPageHead" runat="server">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Light Board</title>
    <meta name="description" content="App">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--[if lt IE 10]>
        <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/es5-shim/4.1.3/es5-shim.min.js"></script>
    <![endif]-->

    <script type="text/javascript">
        (function($){
            if (typeof $ === "undefined") {
                document.write(
                    '<script src="/' + '/ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js?_1448162090363"></' + 'script>'
                );

            }
            if (typeof $ === "undefined" || typeof $.ui === "undefined") {
                document.write(
                    '<script src="/' + '/ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js?_1448162090363"></' + 'script>'
                );
                document.write(
                    '<link rel="stylesheet" href="/' +
                    '/ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/smoothness/jquery-ui.css?_1448162090363">'
                );
            }
        }(window.jQuery));
    </script>

</asp:Content>
<asp:Content ContentPlaceHolderId="PlaceHolderSearchArea" runat="server">
    <SharePoint:DelegateControl runat="server" ControlId="SmallSearchInputBox" />
</asp:Content>
<asp:Content ContentPlaceHolderId="PlaceHolderLeftActions" runat="server"></asp:Content>
<asp:Content ContentPlaceHolderId="PlaceHolderPageDescription" runat="server"></asp:Content>
<asp:Content ContentPlaceHolderId="PlaceHolderBodyRightMargin" runat="server"></asp:Content>
<asp:Content ContentPlaceHolderId="PlaceHolderPageImage" runat="server"></asp:Content>
<asp:Content ContentPlaceHolderId="PlaceHolderLeftNavBar" runat="server"></asp:Content>
<asp:Content ContentPlaceHolderId="PlaceHolderNavSpacer" runat="server"></asp:Content>
<asp:Content ContentPlaceHolderId="PlaceHolderMain" runat="server">
    <script type="text/javascript">
/*! lightBoard - v0.1.0 - 2015-11-21
* Copyright (c) 2015 Paul Tavares; Licensed  */
!function(a,b){var c="app_"+(1e9*Math.random()>>>0);b.write('<div id="'+c+'"></div>');var d;!function(){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D;c='<div class="light-board"> <div class="light-board-menu"> <div class="light-board-menu-lists"> <select> <option value="">loading...</option> </select> </div> <div class="light-board-menu-columns"> <select> <option value="">Pick List First</option> </select> </div> </div> <div class="light-board-kanban"> <p class="light-board-msg">This simple web app is meant to show how easy it is to install MyBoard (<a href="https://paultavares.wordpress.com/my-things/myboard-a-sharepoint-kanban-task-management-system/">link</a>). If you have gotten this far: you have already successfully installed this app, and that is all it takes to also install MyBoard.</p> <p class="light-board-msg">To see a board here, select a List from the drop-down above and then a Column. Note that the board that will be displayed is not identical to the one used by MyBoard. MyBoard provides a much richer interface along with many other features.</p> <p class="light-board-msg">Hope to have you as a supporter.</p> </div> <div class="light-board-footer"> <span>LightBoard | 1436658288142 - 2015-07-11 | &copy; 2015 <a href="https://paultavares.wordpress.com/about/">Paul Tavares</a> | <a href="https://paultavares.wordpress.com/my-things/myboard-a-sharepoint-kanban-task-management-system/">Full Feature MyBoard</a> </span></div> </div> ',e=a.jQuery,f=function(a){var c=function(){function c(a){return a&&"/"!==a.charAt(a.length-1)&&(a+="/"),a.indexOf("http")>-1?a:a=b.location.protocol+"//"+b.location.hostname+(80!==Number(b.location.port)&&Number(b.location.port)>0?":"+b.location.port:"")+a}var d={};return function(e){var f="",g=!1,h="getSiteUrl(): Unable to determine site url from "+e;if(e||(e=b.location.href,g=!0),f=e,e.indexOf("?")>-1?f=e.substr(0,e.indexOf("?")):e.indexOf("#")>-1&&(f=e.substr(0,e.indexOf("#"))),!f)throw new Error(h);if(d[f])return d[f];if(g&&("undefined"!=typeof _spPageContextInfo&&_spPageContextInfo.webServerRelativeUrl&&(d[f]=_spPageContextInfo.webServerRelativeUrl),!d[f]&&"undefined"!=typeof L_Menu_BaseUrl&&L_Menu_BaseUrl&&(d[f]=L_Menu_BaseUrl),d[f]))return d[f]=c(d[f]),d[f];if(d[f]||a.ajax({type:"POST",cache:!1,async:!1,url:b.location.protocol+"//"+b.location.host+"/_vti_bin/Webs.asmx",data:"<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body><WebUrlFromPageUrl xmlns='http://schemas.microsoft.com/sharepoint/soap/' ><pageUrl>"+f+"</pageUrl></WebUrlFromPageUrl></soap:Body></soap:Envelope>",contentType:"text/xml; charset=utf-8",dataType:"xml",success:function(b){d[f]=a(b).find("WebUrlFromPageUrlResult").text()||""}}),!d[f])throw delete d[f],new Error(h);return d[f]=c(d[f]),d[f]||""}}();return c}(e),g=function(){var a=function(){var a={},b=function(a,c){return a?"undefined"==typeof c?b.get(a):b.set(a,c):void 0};return b.clear=function(b){delete a[b]},b.clearAll=function(){a={}},b.get=function(b){return a[b]},b.set=function(b,c){return a[b]=c,c},b.isCached=function(b){return a.hasOwnProperty(b)?!0:!1},b}();return a}(),h=function(){var a=function(a){var b,c,d=a||{},e=Array.prototype.slice.call(arguments,1),f=e.length;for(b=0;f>b;b++)if(e[b])for(c in e[b])e[b].hasOwnProperty(c)&&(d[c]=e[b][c]);return d};return a}(),i=function(){"undefined"==typeof WeakMap&&!function(){var b=Object.defineProperty,c=Date.now()%1e9,d=function(){this.name="__st"+(1e9*Math.random()>>>0)+(c++ +"__")};d.prototype={set:function(a,c){var d=a[this.name];return d&&d[0]===a?d[1]=c:b(a,this.name,{value:[a,c],writable:!0}),this},get:function(a){var b;return(b=a[this.name])&&b[0]===a?b[1]:void 0},"delete":function(a){var b=a[this.name];return b&&b[0]===a?(b[0]=b[1]=void 0,!0):!1},has:function(a){var b=a[this.name];return b?b[0]===a:!1}},a.WeakMap=d}();var b={stash:new WeakMap,create:function(){return new WeakMap}};return b}(),j=function(a,b){var c=function(a){var b,c=[];for(b in a)c.push(b);return c},d=Object.create,e=b.stash,f={isDestroyed:!1,init:function(){},destroy:function(){var a,b=this.__onDestroy;b&&(a=e.get(b),Array.isArray(a)&&a.forEach(function(b,c){"function"==typeof b&&b(),a[c]=null}),e["delete"](b)),e["delete"](this),this.isDestroyed=!0},onDestroy:function(a){if(this.__onDestroy||(this.__onDestroy=function(){}),"function"==typeof a){var b=this.__onDestroy,c=e.get(b);c||(c=[],e.set(b,c)),c.push(a)}}},g={extend:function(){var b=Array.prototype.slice.call(arguments),e=function(){};return e.prototype=b.reduce(function(a,b){if(b){var d=b.prototype||b;c(d).forEach(function(b){a[b]=d[b]})}return a},d(this.prototype)),a(e,this)},isInstanceOf:function(a){if(!a)return!1;var b=c(this.prototype);return!b.some(function(b){return"undefined"==typeof a[b]})},create:function(){var a=d(this.prototype);return a.init&&a.init.apply(a,arguments),a}},h=function(){};return h.prototype=d(f),a(h,g),h}(h,i),k=function(a){var b=function(b){var d,e,f,g,h=a.extend({},{xDoc:null,nodeName:"",asJQuery:!1,cleanAttr:!0,nodeModel:null,nodeModelOptions:null,convertTypes:!1},b),i=h.xDoc.getElementsByTagName(h.nodeName);if(0===i.length&&"z:row"===h.nodeName&&(i=h.xDoc.getElementsByTagName("row")),0===i.length&&"rs:data"===h.nodeName&&(i=h.xDoc.getElementsByTagName("data")),h.asJQuery===!0)return a(i);for(e=[],d=function(b){var d,e,f,g=b.attributes,i={};for(e=0,f=g.length;f>e;e++)d=g[e].name,h.cleanAttr&&d.indexOf("ows_")>-1&&(d=d.replace("ows_","")),h.convertTypes?i[d]=c(g[e].value):i[d]=g[e].value;return i.___xmlNode=b,h.nodeModel&&h.nodeModel.create?h.nodeModel.create(i,a.extend({},h.nodeModelOptions,{source:b})):i},f=0,g=i.length;g>f;f++)e.push(d(i[f]));return e},c=function(a){if(!a)return a;var b=a;switch(a.toUpperCase()){case"TRUE":b=!0;break;case"FALSE":b=!1}return b};return b.getJsNativeFromString=c,b}(e),l=function(a,b,c,d){var e=c.stash,f={init:function(a,c){var d,i=this,j=b({},f.defaults,c);j.type=j.type.toLowerCase(),j.source=a,e.set(i,j),"xml"===j.type?d=g.call(i,j.source):"json"===j.type&&(d=h.call(i,j.source)),b(i,d)},getSource:function(){return e.get(this).source},getListUrl:function(){var a,b=e.get(this);return b.webURL?(a=b.webURL.substr(0,b.webURL.indexOf(this.WebFullUrl)),a?a+this.RootFolder:this.RootFolder||""):this.RootFolder||""}},g=function(a){var b=d({xDoc:a,nodeName:"List",convertTypes:!0}).shift();return delete b.Fields,delete b.RegionalSettings,delete b.ServerSettings,delete b.___xmlNode,b},h=function(){};return f=a.extend(f),f.defaults={type:"xml"},f}(j,h,i,k),m=function(a){var b=function(b){var c=a(b),d=c.find("ErrorCode"),e=!1;return d.length?(d.each(function(){return"0x00000000"!==a(this).text()&&"NoError"!==a(this).text()?(e=!0,!1):void 0}),e):c.find("faultcode").length?!0:c.find("CopyResult[ErrorMessage]").length?!0:!1};return b}(e),n=function(a,b,c,d,e){var f=function(a){return g.call(this,a)},g=function(d){var g,h=a.extend({},f.defaults,d),i=function(a){return h.webURL+"?List="+a};return h.webURL?"/"!==h.webURL.charAt(h.webURL.length-1)&&(h.webURL+="/"):h.webURL=c(),h.webURL+="_vti_bin/Lists.asmx",h.cacheKey=i(h.listName),h.isCached=b.isCached(h.cacheKey),h.cacheXML&&h.isCached?b(h.cacheKey):(h.isCached&&b.clear(h.cacheKey),g=a.Deferred(function(c){a.ajax({type:"POST",cache:!1,async:h.async,url:h.webURL,contentType:"text/xml;charset=utf-8",dataType:"xml",data:'<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><GetList xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>'+h.listName+"</listName></GetList></soap:Body></soap:Envelope>"}).then(function(d){if(e(d))return void c.rejectWith(a,arguments);var f=h.ListModel.create(d,{webURL:h.webURL});h.cacheXML&&(0===h.listName.indexOf("{")?b(i(f.Title),g):b(i(f.ID),g)),c.resolveWith(a,[f])}).fail(function(){c.rejectWith(a,arguments),h.cacheXML&&b.clear(h.cacheKey)})}).promise(),h.cacheXML&&b(h.cacheKey,g),g)};return f.defaults={listName:"",webURL:"",cacheXML:!0,async:!0,ListModel:d},f}(e,g,f,l,m),o=function(a,b,c){var d=c.stash;return a.extend({init:function(a,c){var e=b({},{list:null,webURL:null},c);a&&b(this,a),d.set(this,e)}})}(j,h,i),p=function(a,b,c,d,e,f){var g=function(){var g=null,h=function(){return g.apply(this,arguments)};return h.defaults={listName:"",webURL:"",viewName:"",CAMLViewFields:"",CAMLQuery:"",CAMLRowLimit:"",CAMLQueryOptions:"",operation:"GetListItems",cacheXML:!1,async:!0,completefunc:null,changeToken:"",listItemModel:f},g=function(f){var g,i=a.extend({},h.defaults,f);return i.webURL?"/"!==i.webURL.charAt(i.webURL.length-1)&&(i.webURL+="/"):i.webURL=c(),i.webURL+="_vti_bin/Lists.asmx",i.cacheKey=i.webURL+"?"+[i.listName,i.viewName,i.CAMLViewFields,i.CAMLQuery,i.CAMLRowLimit,i.CAMLQueryOptions,i.operation,i.changeToken].join("|"),i.isCached=b.isCached(i.cacheKey),i.cacheXML&&i.isCached?(g=b(i.cacheKey),a.isFunction(i.completefunc)&&g.then(function(a,b,c){i.completefunc(b,c,a)}),g):(i.isCached&&b.clear(i.cacheKey),g=a.Deferred(function(c){a.ajax({type:"POST",cache:!1,async:i.async,url:i.webURL,contentType:"text/xml;charset=utf-8",dataType:"xml",data:'<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><'+i.operation+' xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>'+i.listName+"</listName><viewName>"+(i.viewName||"")+"</viewName><query>"+(i.CAMLQuery||"<Query></Query>")+"</query><viewFields>"+(i.CAMLViewFields||"<ViewFields></ViewFields>")+"</viewFields><rowLimit>"+(i.CAMLRowLimit||0)+"</rowLimit><queryOptions>"+(i.CAMLQueryOptions||"<QueryOptions></QueryOptions>")+"</queryOptions>"+("GetListItemChangesSinceToken"===i.operation?"<changeToken>"+i.changeToken+"</changeToken>":"")+"</"+i.operation+"></soap:Body></soap:Envelope>",complete:function(f,g){var h=[];return"error"===g||e(f)?(i.cacheXML&&b.clear(i.cacheKey),c.rejectWith(a,[h,f,g]),void(a.isFunction(i.completefunc)&&i.completefunc(f,g,h))):(h=d({xDoc:f.responseXML,nodeName:"z:row",nodeModel:i.listItemModel}),c.resolveWith(a,[h,f,g]),void(a.isFunction(i.completefunc)&&i.completefunc(f,g,h)))}})}).promise(),i.cacheXML&&b(i.cacheKey,g),g)},h}();return g}(e,g,f,k,m,o),q=function(a,b,c,d,e,f){var g=d.stash,h={init:function(a,b){var d=c({},h.defaults,b);a&&c(this,a),g.set(this,d)},getColumnValues:function(){var b=this,c=a(g.get(this).source),d=b.Type,e=[];switch(d){case"Choice":case"MultiChoice":c.find("CHOICE").each(function(){e.push(a(this).text()||"")});break;case"Lookup":case"LookupMulti":f({listName:b.List,cacheXML:!0,async:!1,CAMLQuery:'<Query><OrderBy><FieldRef Name="'+b.ShowField+'"/></OrderBy></Query>',CAMLViewFields:'<ViewFields><FieldRef Name="'+b.ShowField+'"/></ViewFields>'}).then(function(a){e=a})}return e},getList:function(){return g.get(this).list}};return h=b.extend(h),h.defaults={list:null,type:"xml",source:null},h}(e,j,h,i,k,p),r=function(a,b,c,d,e,f){var g=f.stash,h=function(c){var e=a.extend({},h.defaults,"string"==typeof c?{listName:c}:c);return a.Deferred(function(c){b({listName:e.listName,cacheXML:e.cacheXML,webURL:e.webURL,async:e.async}).then(function(b){e.listDef=b;var f,h,j=d({xDoc:b.getSource(),nodeName:"Field",nodeModel:e.ListColumnModel,nodeModelOptions:{list:b}}),k=[];for(f=0,h=j.length;h>f;f++)void 0!==j[f].Hidden&&"FALSE"!==j[f].Hidden||void 0!==j[f].List&&("Docs"===j[f].List||"AppPrincipals"===j[f].List)||!j[f].DisplayName||void 0!==j[f].AuthoringInfo||e.columnName&&j[f].Name!==e.columnName&&j[f].StaticName!==e.columnName&&j[f].DisplayName!==e.columnName?e.ListModel&&j[f].destroy():(j[f].___xmlNode&&delete j[f].___xmlNode,k.push(j[f]),e.columnName&&(f+=h));a.extend(k,i),g.set(k,e),c.resolveWith(a,[k])}).fail(function(){c.rejectWith(a,Array.prototype.slice.call(arguments,0))})}).promise()},i={getColumn:function(a){var b,c=this;return c.some(function(c){(c.Name===a||c.DisplayName===a||c.StaticName===a)&&(b=c)}),b},getList:function(){return g.has(this)?g.get(this).listDef:void 0}};return h.defaults={listName:"",columnName:"",cacheXML:!0,async:!0,webURL:null,ListColumnModel:e},h}(e,n,g,k,q,i),s=function(a,b,c,d){var e=function(){var e=null,f=function(){return e.apply(this,arguments)};return f.defaults={listName:"",webURL:"",cacheXML:!1,async:!0,completefunc:null},e=function(e){var g,h=a.extend({},f.defaults,e);return h.webURL?"/"!==h.webURL.charAt(h.webURL.length-1)&&(h.webURL+="/"):h.webURL=c(),h.webURL+="_vti_bin/Forms.asmx",h.cacheKey=h.webURL+"?List="+h.listName,h.isCached=b.isCached(h.cacheKey),h.cacheXML&&h.isCached?(g=b(h.cacheKey),a.isFunction(h.completefunc)&&g.then(function(a,b){h.completefunc(a,b)}),g):(g=a.Deferred(function(c){h.isCached&&b.clear(h.cacheKey),a.ajax({type:"POST",cache:!1,async:h.async,url:h.webURL,contentType:"text/xml;charset=utf-8",dataType:"xml",data:'<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><GetFormCollection xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>'+h.listName+"</listName></GetFormCollection></soap:Body></soap:Envelope>",complete:function(e,f){return"error"===f||d(e)?(h.cacheXML&&b.clear(h.cacheKey),void c.rejectWith(a,[e,f])):(c.resolveWith(a,[e,f]),void(a.isFunction(h.completefunc)&&h.completefunc(e,f)))}})}).promise(),h.cacheXML&&b(h.cacheKey,g),g)},f}();return e}(e,g,f,m),t=function(a){var b=function(b){var c=a(b),d="",e=c.find("ErrorCode"),f=0;return e.length||(e=c.find("faultcode")),!e.length&&(e=c.find("CopyResult[ErrorMessage]"),e.length)?(e.each(function(){var b=a(this);f+=1,d+="("+f+") "+(b.attr("ErrorCode")||"unknown")+": "+b.attr("ErrorMessage")+"\n"}),f+" error(s) encountered! \n"+d):e.length?(e.each(function(){var b=a(this);"0x00000000"!==b.text()&&(f+=1,d+="("+f+") "+b.text()+": "+b.parent().children().not(b).text()+"\n")}),d=f+" error(s) encountered! \n"+d):""};return b}(e),u=function(a,b,c,d){var e=function(b){function c(a){var c,d,f,g="";for(c=0,d=a.length;d>c;c++){g="";for(f in a[c])a[c].hasOwnProperty(f)&&(g+='<Field Name="'+f+'">'+a[c][f]+"</Field>");g&&(e.push('<Method ID="'+b.counter+'" Cmd="'+b.updateType+'">'+g+"</Method>"),b.counter++)}}function d(c){var d,f,g="";for(d=0,f=c.length;f>d;d++)a.isArray(c[d])&&(g+='<Field Name="'+c[d][0]+'">'+c[d][1]+"</Field>");g&&(e.push('<Method ID="'+b.counter+'" Cmd="'+b.updateType+'">'+g+"</Method>"),b.counter++)}var e=[],f=typeof b.updates;return!b.updates&&b.ID&&b.valuepairs?(b.valuepairs.push(["ID",b.ID]),d(b.valuepairs)):"string"===f?e.push(b.updates):a.isArray(b.updates)&&b.updates.length&&(f=typeof b.updates[0],"object"===f?c(b.updates):"string"===f?e.push.apply(e,b.updates):a.isArray(b.updates[0])&&d(b.updates)),e},f=function(g){var h=a.extend({},f.defaults,g,{counter:1});return h.webURL?"/"!==h.webURL.charAt(h.webURL.length-1)&&(h.webURL+="/"):h.webURL=b(),h.updateType=h.batchCmd||h.updateType,h._updates=e(h).join(""),/<\/Batch>/.test(h._updates)||(h._updates='<Batch OnError="Continue">'+h._updates+"</Batch>"),a.Deferred(function(b){a.ajax({type:"POST",cache:!1,async:h.async,url:h.webURL+"_vti_bin/Lists.asmx",beforeSend:function(a){a.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/UpdateListItems")},contentType:"text/xml;charset=utf-8",dataType:"xml",data:'<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><UpdateListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>'+h.listName+"</listName><updates>"+h._updates+"</updates></UpdateListItems></soap:Body></soap:Envelope>",complete:function(b,c){a.isFunction(h.completefunc)&&h.completefunc.call(a,b,c)}}).always(function(e,f,g){var h={status:"",message:"",httpData:e,xhrRequest:g};"error"===f?(h.status="error",h.message=e.statusText||"HTTP error.",b.rejectWith(a,[h])):c(e)?(h.status="error",h.message=d(e),b.rejectWith(a,[h])):(h.status="success",h.message="Update Successful.",b.resolveWith(a,[h]))})}).promise()};return f.defaults={listName:"",webURL:"",async:!0,completefunc:null,updates:"",updateType:"Update",updateOnError:"Continue"},f}(e,f,m,t),v=function(a){var b=function(b,c){var d,e,f,g,h,i,j={};if("object"==typeof b&&1===arguments.length&&(c=b.data,b=b.tmplt),j.response="",j.template="string"!=typeof b?String(a("<div/>").append(b).html()):b,j.tokens=j.template.match(/(\{\{.*?\}\})/g),a.isArray(c)||(c=c?[c]:[{}]),null!==j.tokens)for(f=0,g=c.length;g>f;f++){for(h=j.template,d=0,e=j.tokens.length;e>d;d++)j.tokens[d]=j.tokens[d].replace(/[\{\}]/g,""),i=c[f][j.tokens[d]]||"",a.isFunction(i)&&(i=i()),h=h.replace("{{"+j.tokens[d]+"}}",i);j.response+=h}else j.response=j.template;return j.response};return b}(e),w=function(a){var b=function(b,c,d){var e=0,f=a(b);return d||(d="height"),f.each(function(){var b=a(this).css(d,"");e<b.outerHeight(!0)&&(e=b.outerHeight(!0))}),e>0&&(c&&(e+=c),f.css(d,e)),b};return b}(e),x=function(a){var b=function(b){return a(b).each(function(){if(!a(this).hasClass("addHoverEffectDone")){a(this).addClass("addHoverEffectDone");var b=this;a(b).mouseenter(function(){a(b).toggleClass("ui-state-hover")}),a(b).mouseleave(function(){a(b).toggleClass("ui-state-hover")})}})};return b}(e),y='<div class="spwidget-board">\r\n    <div class="spwidget-board-settings" style="display:none;">\r\n        <div class=\'spwidget-board-settings-columns\'>Columns</div>\r\n        <div class="spwidget-board-column-list-cntr ui-widget-content ui-corner-all" style="display: none">\r\n            <div class="ui-state-default">\r\n                <span>\r\n                    <span class="spwidget-board-column-total"></span> \r\n                    <span class="spwidget-board-column-total-label">Selected.</span>\r\n                </span>\r\n                <button type="button" name="check" title="Check-Uncheck All">Check</button>\r\n                <button type="button" name="close" title="Close">Close</button>\r\n            </div>\r\n            <div class="spwidget-board-column-list">\r\n            </div>\r\n            <div class="ui-state-default">\r\n                <button type="button" name="apply">Apply</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="spwidget-board-headers">\r\n        <div class="spwidget-board-headers-cntr">\r\n            <div class="spwidget-board-state ui-widget-content ui-corner-top">\r\n                <span class="spwidget-board-header-title"></span>\r\n                <span class="spwidget-state-item-stat-cntr">\r\n                    <span class="spwidget-item-stat ui-widget-content ui-corner-all spwidget-state-item-total">0</span>\r\n                </span>\r\n            </div>\r\n            <div style="clear:both;"></div>\r\n        </div>\r\n    </div>\r\n    <div style="clear:both;"></div>\r\n    <div class="spwidget-board-states">\r\n        <div class="spwidget-board-states-cntr">\r\n            <div class="spwidget-board-state ui-widget-content ui-corner-bottom"></div>\r\n            <div style="clear:both;"></div>\r\n        </div>\r\n    </div>\r\n    <div style="clear:both;"></div>\r\n</div>\r\n<div class="spwidget-item-template">\r\n    <div>\r\n        <div>#{{ID}}: {{Title}}</div>\r\n        <div class="ui-state-active ui-corner-all spwidget-board-item-actions">\r\n            <a class="spwidgets-board-action" href="javascript:" title="View Item" data-spwidgets_id="{{ID}}" data-spwidgets_board_action="view-item"><img src="/_layouts/images/icgen.gif" border="0"/></a>\r\n            <a class="spwidgets-board-action" href="javascript:" title="Edit Item" data-spwidgets_id="{{ID}}" data-spwidgets_board_action="edit-item"><img src="/_layouts/images/CMSEditSourceDoc.GIF" border="0"/></a>\r\n        </div>\r\n    </div>\r\n</div>\r\n',z=void 0,A=function(b,c,d,e,f,g,h,i,j,k,l,m,n){var o,p,q={};return q.maxColumns=20,q.defaults={list:"",field:"",CAMLQuery:"<Query></Query>",CAMLViewFields:"",fieldFilter:null,optionalLabel:"(none)",allowFieldBlanks:null,template:null,webURL:"",showColPicker:!1,colPickerLabel:"Columns",colPickerVisible:[],colPickerCloseLabel:"Close",colPickerApplyLabel:"Apply",colPickerCheckLabel:"Check-Uncheck All",colPickerTotalLabel:"Selected.",colPickerMaxColMsg:"Can not exceed 10 columns!",colPickerMinColMsg:"Mininum of 2 required!",onGetListItems:null,onPreUpdate:null,onBoardCreate:null,height:null},o=function(d,o){var r=Array.prototype.slice.call(arguments,1),s=d;return d.each(function(){var d=b(this),t="string"==typeof o,u=d.hasClass("hasSPShowBoard"),v=null,w="",x=null;return u&&!t?this:t&&u&&!d.hasClass("loadingSPShowBoard")?(w=o.toLowerCase(),x=d.data("SPShowBoardOptions"),"refresh"===w?x._getListItems().then(function(){x.showItemsOnBoard({refresh:!0})}):"redraw"===w?x.setBoardColumnHeight():"setvisible"===w?x.setUserDefinedVisibleCol(r[1]):"setheight"===w?(x.height=r[1],x.setBoardColumnHeight()):"getcolumns"===w&&(s=x.getBoardColumnList()),this):d.hasClass("loadingSPShowBoard")?this:(v=b.extend({},q.defaults,o,{ele:d,states:[],statesMap:{},tmpltHeader:"",tmpltState:"",statesCntr:"",headersCntr:"",listItems:[],initDone:!1,formUrls:null,isStateRequired:!1,maxColumnVisible:10,showNumberOfColumns:10,getBoardStates:p,_getListItems:function(){return b.Deferred(function(a){function c(c){b.isFunction(v.onGetListItems)&&v.onGetListItems.call(d,v.listItems,c),a.resolveWith(d,[v.listItems])}b.isFunction(v.CAMLQuery)?v.CAMLQuery.call(d,function(a){b.isArray(a)&&(v.listItems=a,c(v.CAMLQuery))},o):f({listName:v.list,async:!0,CAMLQuery:v.CAMLQuery,CAMLRowLimit:0,CAMLViewFields:v.CAMLViewFields,webURL:v.webURL}).then(function(a){v.listItems=a,c(a)}).fail(function(c,d,e){a.rejectWith(b,[c,d,e])})}).promise()},getBoardItemDataObject:function(a){var c,d,e,f=null;if(a)for(a=String(a),c=0,d=v.listItems.length;d>c;c++)e=v.listItems[c].ID,b.isFunction(e)&&(e=v.listItems[c].ID()),e=String(e),a===e&&(f=v.listItems[c],c=d+d);return f},showItemsOnBoard:function(a){function c(a,c){var e="",f=null,h="";return b.isFunction(v.template)?(e=v.template.call(d,a,c),e&&(e=String(e))):e=i(v.template,r),void 0!==c&&""!==e?c.html(e):""!==e&&(f=a.ID,b.isFunction(a.ID)&&(f=a.ID()),void 0===m[o]&&(m[o]=""),v.initDone&&g.refresh&&(h+=" spwidget-temp"),m[o]+='<div class="spwidget-board-state-item ui-state-default ui-corner-all'+h+'" data-id="'+f+'">'+e+"</div>"),e}var e,f,g=b.extend({},{rows:v.listItems,refresh:!1,doBoardInsert:!0},a),h=[],j=[],l=[],m={},n=null,o=null,p=null,q=null,r=null;if(!g.refresh)for(e=0,f=v.states.length;f>e;e++)v.states[e].headerTotalEle.html("0"),v.states[e].dataEle.empty();for(e=0,f=g.rows.length;f>e;e++)r=g.rows[e],o=r[v.field]||"",p=r.ID,b.isFunction(o)&&(o=r[v.field]()),b.isFunction(p)&&(p=p()),v.statesMap[o]&&(g.refresh===!1?(v.initDone&&h.push(r),c(r)):(n=v.statesCntr.find("div[data-id='"+p+"']"),n.length?(n.addClass("spwidget-temp"),n.closest("div.spwidget-board-state").data("boardstate")!==o&&(n.appendTo(v.statesMap[o].dataEle),l.push(r)),c(r,n)):(v.initDone&&h.push(r),c(r))));if(g.doBoardInsert){for(e in m)m.hasOwnProperty(e)&&""!==m[e]&&v.statesMap[e].dataEle.append(m[e]);k(d.find(".spwidget-board-state-item"))}return v.initDone&&g.refresh&&v.statesCntr.find("div.spwidget-board-state-item").not("div.spwidget-temp").each(function(){j.push(v.getBoardItemDataObject(b(this).data("id"))),b(this).remove()}).end().removeClass("spwidget-temp"),v.initDone&&(v.statesCntr.find("div.spwidget-board-state").sortable("refresh").end().disableSelection(),q=v.getEventObject(),h.length&&(q.itemsModified.length=0,q.itemsModified.push(h),d.trigger("spwidget:boarditemadd",[d,b.extend({},q)])),j.length&&(q.itemsModified.length=0,q.itemsModified.push(j),d.trigger("spwidget:boarditemremove",[d,b.extend({},q)])),q.itemsModified.length=0,q.itemsModified.push.apply(q.itemsModified,h),q.itemsModified.push.apply(q.itemsModified,j),q.itemsModified.push.apply(q.itemsModified,l),q.itemsModified.length&&d.trigger("spwidget:boardchange",[d,q])),v.updBoardHeaders(),v.setBoardColumnHeight(),m},updBoardHeaders:function(a){var c,d,e=b.extend({},{state:null},a);if(e.state);else for(c=0,d=v.states.length;d>c;c++)v.states[c].headerTotalEle.html(v.states[c].dataEle.children().length)},getEventObject:function(a){a||(a=v.statesCntr.find("div.spwidget-board-state-item:first")),a=b(a);var c,d,e={stateTotals:{},itemTotal:0,currentState:a.closest("div.spwidget-board-state").data("boardstate"),itemObj:v.getBoardItemDataObject(a.data("id"))||{},itemsModified:[]};for(c=0,d=v.states.length;d>c;c++)e.itemTotal+=e.stateTotals[v.states[c].name]=Number(v.states[c].headerTotalEle.text());return e},getListFormUrl:function(a){function c(){e({listName:v.list,webURL:v.webURL,cacheXML:!0,async:!1,completefunc:function(a){b(a.responseXML).find("Form").each(function(){var a=b(this);v.formUrls[String(a.attr("Type")).toLowerCase()]=v.webURL+"/"+a.attr("Url")})}})}return a=String(a).toLowerCase(),null===v.formUrls&&(v.formUrls={},c()),v.formUrls[a]||""},setUserDefinedVisibleCol:function(a){function c(a){var c=!1;return b.each(v.states,function(b,d){return d.title===a||d.name===a?(c=!0,!1):void 0}),c}var d=0,e=!1;if(a){if(!b.isArray(a)||!a.length){if(!b.isArray(a)&&"all"!==String(a).toLowerCase())return;e=!0,a=[]}a.length<2||(e||(d=0,b.each(a,function(a,b){return c(b)&&d++,2===d?!1:void 0})),d=0,b.each(v.states,function(c,e){return b.inArray(e.title,a)>-1||b.inArray(e.name,a)>-1?(d++,e.isVisible===!1&&(e.isVisible=!0,e.dataEle.css("display",""),e.headerEle.css("display",""))):(e.isVisible=!1,e.dataEle.css("display","none"),e.headerEle.css("display","none")),d>=v.maxColumnVisible?!1:void 0}),v.setBoardColumnClass(d),v.setBoardColumnHeight(),v.triggerBoardColumnChangeEvent())}},setBoardColumnClass:function(a){var c=v.headersCntr.add(v.statesCntr);return a=parseInt(a),(!a||2>a)&&(a=0,b.each(v.states,function(b,c){c.isVisible&&a++})),v.showNumberOfColumns===a?v:(c.addClass("spwidget-states-"+a),v.showNumberOfColumns&&c.removeClass("spwidget-states-"+v.showNumberOfColumns),v.showNumberOfColumns=a,v)},triggerBoardColumnChangeEvent:function(){var a=[];v.initDone&&(b.each(v.statesMap,function(b,c){c.isVisible&&a.push(c.title)}),v.ele.trigger("spwidget:boardColumnChange",[v.ele,a]))},setupColumnPicker:function(){var a=d.find(".spwidget-board-column-list-cntr"),c=a.find("div.spwidget-board-column-list"),e=a.children("div.ui-state-default:last"),f={$totalCntr:a.find("span.spwidget-board-column-total")};f.setTotalSelected=function(){var a=f.getSelected().length;return f.$totalCntr.html(a),a},f.getSelected=function(){return c.find("a.ui-state-highlight")},f.showMessage=function(a){b('<div class="spwidget-board-msg ui-state-error ui-corner-all">'+a+"</div>").appendTo(e).fadeOut(8e3,function(){b(this).remove()})},f.setSelected=function(){var a=c.find("a");b.each(v.states,function(b,c){var d=a.filter("[data-board_col_index='"+b+"']");c.isVisible?f.selectColumn(d,!1):f.selectColumn(d,!0)}),f.setTotalSelected()},f.selectColumn=function(a,c){return b(a).each(function(){var a=b(this),d=a.find(".ui-icon");a.hasClass("ui-state-highlight")||c?c!==!1&&(d.removeClass("ui-icon-check"),a.removeClass("ui-state-highlight")):(d.addClass("ui-icon-check"),a.addClass("ui-state-highlight"))}),a},f.setVisibleColumns=function(a){a||(a=f.getSelected());var c=a.length;b.each(v.states,function(b,c){a.filter("[data-board_col_index='"+b+"']").length?c.isVisible===!1&&(c.isVisible=!0,c.dataEle.css("display",""),c.headerEle.css("display","")):(c.isVisible=!1,c.dataEle.css("display","none"),c.headerEle.css("display","none"))}),v.setBoardColumnClass(c),v.setBoardColumnHeight()},f.setUserDefinedVisibleCol=function(a){var d=0,e="";if(!b.isArray(a)||!a.length){if(!b.isArray(a)&&"all"!==String(a).toLowerCase())return;a=[],b.each(v.states,function(b,c){a.push(c.title)})}b.each(a,function(a,c){return b.each(v.states,function(a,b){return b.title===c?(d++,d>1&&(e+=","),e+="a[data-board_col_name='"+b.name+"']",!1):void 0}),d>=v.maxColumnVisible?!1:void 0}),d>=2&&(f.setVisibleColumns(c.find(e)),f.triggerEvent())},f.triggerEvent=v.triggerBoardColumnChangeEvent,a.find("button[name='apply']").button({label:v.colPickerApplyLabel,icons:{secondary:"ui-icon-circle-check"}}).on("click",function(){var b=f.getSelected(),c=b.length;return c>v.maxColumnVisible?void f.showMessage(v.colPickerMaxColMsg):2>c?void f.showMessage(v.colPickerMinColMsg):(a.hide(),f.setVisibleColumns(b),void f.triggerEvent())}),a.find("button[name='check']").attr("title",v.colPickerCheckLabel).button({text:!1,icons:{primary:"ui-icon-radio-off"}}).on("click",function(){var a=f.getSelected();a.length?f.selectColumn(a,!0):f.selectColumn(c.find("a")),f.setTotalSelected()}),a.find("button[name='close']").attr("title",v.colPickerCloseLabel).button({text:!1,icons:{primary:"ui-icon-circle-close"}}).on("click",function(){a.hide()}),d.find("div.spwidget-board-settings").css("display","").find("div.spwidget-board-settings-columns").each(function(){var c=b(this);return c.button({label:v.colPickerLabel,icons:{secondary:"ui-icon-triangle-1-s"}}).on("click.SPWidgets",function(){a.is(":visible")?a.hide():(f.setSelected(),a.show().position({my:"left top",at:"left bottom",of:c}))}),!1}),c.each(function(){var a=b(this),c="";return b.each(v.states,function(a,b){c+='<a href="javascript:" data-board_col_index="'+a+'" data-board_col_name="'+b.name+'"><span class="ui-icon ui-icon-minus"></span><span>'+b.title+"</span></a>"}),a.html(c),!1}).on("click","a",function(){f.selectColumn(this),f.setTotalSelected()}),a.find("span.spwidget-board-column-total-label").html(v.colPickerTotalLabel)},setBoardColumnHeight:function(){return v.headersCntr.is(":visible")&&j(v.headersCntr.find("div.spwidget-board-state:visible"),0,"min-height"),v.height?void v.statesCntr.find("div.spwidget-board-state:visible").css({height:v.height,"min-height":""}):void(v.statesCntr.is(":visible")&&j(v.statesCntr.find("div.spwidget-board-state:visible").css("height",""),20,"min-height"))},getBoardColumnList:function(){var a,b,c=[];for(a=0,b=v.states.length;b>a;a++)c.push({name:v.states[a].name,title:v.states[a].title,isVisible:v.states[a].isVisible});return c}}),v.webURL||(v.webURL=c()),v.list&&v.field?(d.addClass("loadingSPShowBoard").data("SPShowBoardOptions",v),v.getBoardStates().then(function(){""===v.CAMLViewFields?v.CAMLViewFields='<ViewFields><FieldRef Name="ID" /><FieldRef Name="Title" /><FieldRef Name="'+v.field+'" /></ViewFields>':v.CAMLViewFields.indexOf(v.field)<0&&(v.CAMLViewFields=v.CAMLViewFields.replace(/<\/ViewFields\>/i,'<FieldRef Name="'+v.field+'" /></ViewFields>')),d.html(b(n).filter("div.spwidget-board")),v.tmpltHeader=b("<div/>").append(d.find("div.spwidget-board-headers-cntr div.spwidget-board-state").clone()).html(),v.tmpltState=b("<div/>").append(d.find("div.spwidget-board-states-cntr div.spwidget-board-state")).html(),v.states.length<=v.maxColumnVisible&&(v.showNumberOfColumns=v.states.length),v.statesCntr=d.find("div.spwidget-board-states-cntr").addClass("spwidget-states-"+v.showNumberOfColumns).empty(),v.headersCntr=d.find("div.spwidget-board-headers-cntr").addClass("spwidget-states-"+v.showNumberOfColumns).empty(),b.each(v.states,function(a,c){c.headerEle=b(v.tmpltHeader).appendTo(v.headersCntr).attr("data-boardstate",c.name).attr("data-boardindex",a).find(".spwidget-board-header-title").html(c.title).end(),c.dataEle=b(v.tmpltState).appendTo(v.statesCntr).attr("data-boardindex",a).attr("data-boardstate",c.name),c.headerTotalEle=c.headerEle.find("span.spwidget-state-item-total"),c.isVisible=!0,a>v.maxColumnVisible-1&&(c.headerEle.css("display","none"),c.dataEle.css("display","none"),c.isVisible=!1)}),b(v.headersCntr,v.statesCntr).append('<div style="clear:both;"></div>'),
v.showColPicker===!0&&v.setupColumnPicker(),b.isArray(v.colPickerVisible)&&v.colPickerVisible.length&&v.setUserDefinedVisibleCol(v.colPickerVisible),d.on("sortreceive sortremove",function(a,c){v.updBoardHeaders(),b(c.item).removeClass("ui-state-hover")}).on("sortreceive",function(a,c){var e=v.getEventObject(c.item),f=b.Deferred(),i="";return i=b.isFunction(e.itemObj.ID)?e.itemObj.ID():e.itemObj.ID,e.updates=[],e.updatePromise=f.promise(),e.updates.push([v.field,e.currentState]),b.isFunction(v.onPreUpdate)&&v.onPreUpdate.call(c.item,a,c.item,e)===!0?this:e.updates.length?void g({listName:v.list,async:!0,ID:i,valuepairs:e.updates,webURL:v.webURL,completefunc:function(g,i){if("error"===i)return void f.rejectWith(d,["Communications Error!",g,i]);var j=b(g.responseXML),k=null;return l(j)?void f.rejectWith(d,[m(j),g,i]):(k=h({xDoc:g.responseXML,nodeName:"z:row"}),b(a.target).trigger("spwidget:boardchange",[c.item,e]),void f.resolveWith(a.target,[k[0],e.itemObj,g]))}}):this}).on("click","a.spwidgets-board-action",function(c){var d=b(c.currentTarget),e=String(d.data("spwidgets_board_action")).toLowerCase(),f="",g=encodeURIComponent(a.location.href);switch(e){case"edit-item":f=v.getListFormUrl("EditForm");break;case"view-item":f=v.getListFormUrl("DisplayForm")}return a.location.href=f+"?ID="+d.data("spwidgets_id")+"&Source="+g,this}),null===v.template&&(v.template=b(n).filter("div.spwidget-item-template")),v._getListItems().then(function(){v.showItemsOnBoard(),v.statesCntr.find("div.spwidget-board-state").each(function(){var a=b(this);a.sortable({connectWith:a.siblings(),containment:d,cursor:"move",tolerance:"pointer",opacity:".80",placeholder:"ui-state-highlight spwidget-board-placeholder",forcePlaceholderSize:!0,remove:function(){v.setBoardColumnHeight()}})}),v.statesCntr.disableSelection(),v.initDone=!0,v.setBoardColumnHeight(),d.addClass("hasSPShowBoard").removeClass("loadingSPShowBoard"),b.isFunction(v.onBoardCreate)&&v.onBoardCreate.call(d,v.getEventObject()),b(d).trigger("spwidget:boardcreate",[d,v.getEventObject()])})}).fail(function(a){d.append('<div class="ui-state-error"><p>'+a+"</p></div>")}),this):(d.html("<div>SPWidgets:Board [ERROR] Missing required input parameters!</div>"),this))}),s},p=function(){var a=this;return b.Deferred(function(c){var e=function(d,e){c.rejectWith(b,[e||"Field ("+a.field+") not found in list definition!",d,"error"])};d({listName:a.list,cacheXML:!0,webURL:a.webURL}).then(function(d){var g=d.getColumn(a.field);if(!g)return void e(null);switch(a._origField=a.field,a.field=g.Name,"TRUE"===g.Required&&(a.isStateRequired=!0),"boolean"==typeof a.allowFieldBlanks&&(a.isStateRequired=!a.allowFieldBlanks),g.Type.toLowerCase()){case"choice":a.isStateRequired||(a.states.push({type:"choice",title:a.optionalLabel,name:a.optionalLabel}),a.statesMap[""]=a.states[a.states.length-1]),a.fieldFilter&&(a.fieldFilter=a.fieldFilter.split(/\,/)),g.getColumnValues().some(function(c,d){if(!a.fieldFilter||b.grep(a.fieldFilter,function(a){return a===c}).length){if(d>=q.maxColumns){try{console.log("SPWIDGETS:BOARD:Warning: Can only build a max of "+q.maxColumns+" columns!")}catch(e){}return!0}a.states.push({type:"choice",title:c,name:c}),a.statesMap[c]=a.states[a.states.length-1]}}),c.resolveWith(b,[a.states]);break;case"lookup":a.fieldFilter||(a.fieldFilter="<Query></Query>"),f({listName:g.List,async:!0,cacheXML:!0,CAMLQuery:a.fieldFilter,webURL:a.webURL,CAMLRowLimit:q.maxColumns,CAMLViewFields:'<ViewFields><FieldRef Name="'+g.ShowField+'" /></ViewFields>'}).then(function(b){return"error"===status?void e(null,"Communications Error!"):(a.isStateRequired||(a.states.push({type:"lookup",title:a.optionalLabel,name:""}),a.statesMap[""]=a.states[a.states.length-1]),b.some(function(b,c){if(c>=q.maxColumns){try{console.log("SPWIDGETS:BOARD:Warning: Can only build a max of "+q.maxColumns+" columns!")}catch(d){}return!0}var e=b.ID,f=b[g.ShowField],h=e+";#"+f;a.states.push({type:"lookup",title:f,name:h}),a.statesMap[h]=a.states[a.states.length-1]}),void c.resolveWith(a,[a.states]))}).fail(function(a){e(a,"Unable to get rows from Lookup column list")});break;default:e(null,"Field ("+a.field+") Type ("+g.Type+") is not supported!")}}).fail(function(a){e(a)})}).promise()},o.defaults=q.defaults,o}(e,f,r,s,p,u,k,v,w,x,m,t,y),B=function(a,b,c,d){var e=function(){var e=null,f=function(){return e.apply(this,arguments)};return f.defaults={webURL:"",cacheXML:!1,async:!0,completefunc:null,filter:null},e=function(e){var g,h=a.extend({},f.defaults,e);return h.webURL?"/"!==h.webURL.charAt(h.webURL.length-1)&&(h.webURL+="/"):h.webURL=c(),h.webURL+="_vti_bin/SiteData.asmx",h.cacheKey=h.webURL+"?"+[h.filter].join("|"),h.isCached=b.isCached(h.cacheKey),h.cacheXML&&h.isCached?(g=b(h.cacheKey),a.isFunction(h.completefunc)&&g.then(function(b,c,d){h.completefunc.call(a,c,d,b)}),g):(g=a.Deferred(function(c){h.isCached&&b.clear(h.cacheKey),a.ajax({type:"POST",cache:!1,async:h.async,url:h.webURL,contentType:"text/xml;charset=utf-8",dataType:"xml",data:'<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><GetListCollection xmlns="http://schemas.microsoft.com/sharepoint/soap/"></GetListCollection></soap:Body></soap:Envelope>',complete:function(e,f){if("error"===f||d(e))return h.cacheXML&&b.clear(h.cacheKey),void c.rejectWith(a,[null,e,f]);var g=a(e.responseXML).find("_sList"),i=[];h.filter&&!a.isArray(h.filter)&&(h.filter=[h.filter]),g.each(function(){var b=a(this),c={};h.filter&&a.isArray(h.filter)&&-1===a.inArray(b.find("Title").text(),h.filter)&&-1===a.inArray(b.find("InternalName").text(),h.filter)||(b.children().each(function(){c[this.nodeName]=a(this).text()}),i.push(c))}),c.resolveWith(a,[i,e,f]),a.isFunction(h.completefunc)&&h.completefunc(e,f,i)}})}).promise(),h.cacheXML&&b(h.cacheKey,g),g)},f}();return e}(e,g,f,m),C=void 0,D=function(a,b,c,d,e){var f={},g={start:function(c,d){f.$appCntr=b(c).html(a),h(),d.style.display="none"}},h=function(){var a=f.$appCntr.find("div.light-board-menu-lists > select"),g=f.$appCntr.find("div.light-board-menu-columns > select"),h=f.$appCntr.find("div.light-board-kanban");d().then(function(d){var f=d.reduce(function(a,b){return a+='<option value="'+b.InternalName+'">'+b.Title+"</option>"},'<option value="">Select List...</option>');a.html(f),a.on("change",function(){g.html('<option value="">Pick List First</option>'),h.empty(),a.val()&&e({listName:a.val()}).then(function(a){var b=a.reduce(function(a,b){return("Lookup"===b.Type||"Choice"===b.Type)&&(a+='<option value="'+b.StaticName+'">'+b.DisplayName+"</option>"),a},'<option value="">Select Column...</option>');g.html(b)})}),g.on("change",function(){g.val()&&c(b("<div/>").appendTo(h.empty()),{list:a.val(),field:g.val()})})})};return g}(c,e,A,B,r),function(a){var c=b,d="appendChild",e="styleSheet",f=c.createElement("style");f.type="text/css",c.getElementsByTagName("head")[0][d](f),f[e]?f[e].cssText=a:f[d](c.createTextNode(a))}("div.spwidget-board{width:100%;position:relative}div.spwidget-board div.spwidget-board-headers,div.spwidget-board div.spwidget-board-headers-cntr,div.spwidget-board div.spwidget-board-states-cntr,div.spwidget-board div.spwidget-board-states{width:100%}div.spwidget-board div.spwidget-board-state{width:49%;float:left;margin:0% .1%;padding:.2%;overflow:auto}div.spwidget-board div.spwidget-board-headers-cntr div.spwidget-board-state{font-weight:700;font-size:1.1em;overflow:hidden;word-wrap:break-word}div.spwidget-board div.spwidget-board-headers-cntr .spwidget-board-header-title{display:inline-block}div.spwidget-board div.spwidget-board-headers-cntr .spwidget-state-item-stat-cntr{display:inline-block;font-size:.8em;float:right}div.spwidget-board div.spwidget-board-headers-cntr .spwidget-item-stat{display:inline-block;min-width:2em;padding:0 .2em;text-align:center}div.spwidget-board div.spwidget-board-states div.spwidget-board-state{margin-bottom:1em;min-height:10em}div.spwidget-board div.spwidget-board-state div.spwidget-board-state-item{padding:.2em;margin:.5em .2em;font-weight:400;cursor:move;overflow:hidden;word-break:break-word}div.spwidget-board div.spwidget-board-state-item div.spwidget-board-item-actions{margin-top:.2em;padding:.2em .5em;overflow:hidden}div.spwidget-board .spwidget-board-placeholder{height:3em}div.spwidget-board-settings{font-size:.8em;margin:.2em}div.spwidget-board-settings div.spwidget-board-column-list-cntr{z-index:5;position:absolute}div.spwidget-board-settings div.spwidget-board-column-list-cntr>div{padding:.2em}div.spwidget-board-settings div.spwidget-board-column-list-cntr>div:first-child,div.spwidget-board-settings div.spwidget-board-column-list-cntr>div:last-child{text-align:right}div.spwidget-board-settings div.spwidget-board-column-list{width:20em;height:17em;overflow:auto;position:relative}div.spwidget-board-settings div.spwidget-board-column-list-cntr .spwidget-board-msg{position:absolute;top:1px;left:1px;padding:.2em}div.spwidget-board-settings div.ui-state-default{position:relative}div.spwidget-board-settings div.spwidget-board-column-list>a{display:block;margin:.2em;padding:.2em}div.spwidget-board-settings div.spwidget-board-column-list>a>span.ui-icon{display:inline-block}div.spwidget-board .spwidget-states-3 div.spwidget-board-state{width:32.4%}div.spwidget-board .spwidget-states-4 div.spwidget-board-state{width:24%}div.spwidget-board .spwidget-states-5 div.spwidget-board-state{width:19.1%}div.spwidget-board .spwidget-states-6 div.spwidget-board-state{width:15.8%}div.spwidget-board .spwidget-states-7 div.spwidget-board-state{width:13.4%}div.spwidget-board .spwidget-states-8 div.spwidget-board-state{width:11.6%}div.spwidget-board .spwidget-states-9 div.spwidget-board-state{width:10.2%}div.spwidget-board .spwidget-states-10 div.spwidget-board-state{width:9.1%}#s4-leftpanel,#sideNavBox{display:none!important}.s4-ca,#contentBox{margin-left:.5em!important;width:98%}.light-board{position:relative;box-sizing:border-box;font-size:11pt}.light-board-menu{padding:1em 0}.light-board-menu-lists,.light-board-menu-columns{display:inline-block;padding:.5em;margin-right:1em}.light-board-menu-lists select,.light-board-menu-columns select{line-height:1.4em;padding:.2em;font-size:1.4em}.light-board-kanban{min-height:20em}.light-board-msg{font-size:2em;line-height:2em;width:80%;margin:auto}.light-board-footer{font-size:.9em;padding:1em 0;border-top:1px solid}"),d=D}();var e=b.createElement("div"),f=!1,g=function(){if(!f){f=!0;var a=b.body.querySelector("#"+c);d.start(a,e)}},h="undefined"!=typeof _spBodyOnLoadFunctionNames,i="undefined"!=typeof ExecuteOrDelayUntilScriptLoaded;if(e.className=c+"-page-overlay",e.setAttribute("style","height: 100%;left: 0;position: absolute;top: 0;width: 100%; background-color:rgb(170, 170, 170);opacity: 0.3;filter:Alpha(Opacity=30);z-index:9999;"),e.innerHTML="<div style=\"position: absolute; font-weight: bold; color: gray; background-image: url('/_layouts/images/hig_progcircle_loading24.gif'); top: 15%; right: 0%; font-size: 4em; background-repeat: no-repeat; background-position: left center; padding-left: 45px; letter-spacing: 0.3em;\" >Loading...</div>",b.body.appendChild(e),h){var j=c+"_loader";a[j]=function(){g(),a[j]=null},_spBodyOnLoadFunctionNames.push(j)}i&&ExecuteOrDelayUntilScriptLoaded(g,"sp.js"),h||i?setTimeout(g,3e3):g()}(window,document);
</script>

</asp:Content>
